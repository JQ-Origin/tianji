---
sidebar_position: 1
_i18n_hash: 3259721dc0b4a861181514a7b0e0add4
---
# MCPとの統合

## はじめに

Tianji MCPサーバーは、AIアシスタントとTianjiプラットフォームの橋渡しをするModel Context Protocol (MCP)に基づくサーバーです。このサーバーは、MCPプロトコルを通じてAIアシスタントにTianjiプラットフォームのアンケート機能を提供します。このサーバーは以下の主要な機能を提供します：

- アンケートの結果の照会
- アンケートの詳細情報の取得
- ワークスペース内の全アンケートの取得
- ウェブサイトリストの取得

## インストール方法

### NPXインストール

次の設定をAIアシスタントの設定ファイルに追加することで、Tianji MCPサーバーを使うことができます：

```json
{
  "mcpServers": {
    "tianji": {
      "type": "stdio",
      "command": "npx",
      "args": [
        "-y",
        "tianji-mcp-server"
      ],
      "env": {
        "TIANJI_BASE_URL": "https://tianji.example.com",
        "TIANJI_API_KEY": "<your-api-key>",
        "TIANJI_WORKSPACE_ID": "<your-workspace-id>"
      }
    }
  }
}
```

### 環境変数の設定

Tianji MCPサーバーを使用する前に、次の環境変数を設定する必要があります：

```bash
# TianjiプラットフォームAPIのベースURL
TIANJI_BASE_URL=https://tianji.example.com

# TianjiプラットフォームAPIキー
TIANJI_API_KEY=your_api_key_here

# TianjiプラットフォームのワークスペースID
TIANJI_WORKSPACE_ID=your_workspace_id_here
```

### APIキーの取得

TianjiプラットフォームのAPIキーを取得するには、次の手順に従ってください：

1. Tianjiプラットフォームにログイン後、右上の**プロフィール画像**をクリック
2. ドロップダウンメニューから**プロフィール**を選択
3. プロフィールページで**APIキー**オプションを確認
4. 新しいキーを作成し、プロンプトに従ってキー作成を完了

## 使用方法

Tianji MCPサーバーは、MCPプロトコルを通じてAIアシスタントとやりとりができる一連のツールを提供します。以下には、それぞれのツールの詳細が記載されています：

### アンケート結果の照会

`tianji_get_survey_results`ツールを使って特定のアンケートの結果データを照会します。

**パラメーター：**

- `workspaceId`: TianjiワークスペースID (環境変数に設定された値がデフォルト)
- `surveyId`: アンケートID
- `limit`: 返されるレコードの数の制限 (デフォルト20)
- `cursor`: ページネーションカーソル (オプション)
- `startAt`: 開始時間、ISO形式、例: 2023-10-01T00:00:00Z
- `endAt`: 終了時間、ISO形式、例: 2023-10-31T23:59:59Z
- `filter`: フィルター条件 (オプション)

### アンケート情報の取得

`tianji_get_survey_info`ツールを使って特定のアンケートの基本情報を取得します。

**パラメーター：**

- `workspaceId`: TianjiワークスペースID (環境変数に設定された値がデフォルト)
- `surveyId`: アンケートID

### 全アンケートリストの取得

`tianji_get_all_survey_list`ツールを使ってワークスペース内の全アンケートのリストを取得します。

**パラメーター：**

- `workspaceId`: TianjiワークスペースID (環境変数に設定された値がデフォルト)

### ウェブサイトリストの取得

`tianji_get_website_list`ツールを使ってワークスペース内のウェブサイトリストを取得します。

**パラメーター：**

- `workspaceId`: TianjiワークスペースID (環境変数に設定された値がデフォルト)

## 使用例

以下は、Tianji MCPサーバーを統合したAIアシスタント間の自然言語のやり取り例です：

### 例1: 全アンケートリストの取得

```
ユーザー: 全アンケートのリストを見せて

AIアシスタント: あなたのアンケートリストを取得します。
[AIアシスタントがMCPプロトコル経由でtianji_get_all_survey_listを呼び出してデータ取得]
あなたのワークスペースに基づく現在のアンケートは次の通りです:
1. ユーザー体験満足度調査 (作成日: 2023-09-15)
2. 製品機能フィードバック調査 (作成日: 2023-10-01)
3. ウェブサイトの使いやすさ評価 (作成日: 2023-10-20)
```

### 例2: 特定のアンケート詳細の取得

```
ユーザー: 「ユーザー体験満足度調査」の詳細を教えて

AIアシスタント: その調査の詳細を取得します。
[AIアシスタントがMCPプロトコル経由でtianji_get_survey_infoを呼び出してデータ取得]
「ユーザー体験満足度調査」の詳細：
- 作成日時: 2023-09-15
- ステータス: アクティブ
- 質問数: 10
- 収集された回答数: 128
- 最新の回答: 2023-10-25
```

### 例3: アンケート結果の照会

```
ユーザー: 「製品機能フィードバック調査」の10月の結果を分析して

AIアシスタント: 「製品機能フィードバック調査」の10月の結果を分析します。
[AIアシスタントがMCPプロトコル経由でtianji_get_survey_resultsを呼び出して特定期間のデータ取得]
「製品機能フィードバック調査」10月の結果分析：
- 総回答数: 42
- 最も人気のある機能: 自動レポート (85%の肯定的なフィードバック)
- 最も改善が必要な機能: モバイル適応 (62%が言及)
- 平均満足度: 4.2/5
- 主なユーザー提案: データエクスポート機能の追加、ページ読み込み速度の最適化
```
