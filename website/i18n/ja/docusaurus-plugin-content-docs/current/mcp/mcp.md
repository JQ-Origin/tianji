---
sidebar_position: 1
_i18n_hash: 3c015e32f8f31f3336c113e85a87d389
---
# MCPとの統合

## イントロダクション

Tianji MCPサーバーは、モデルコンテキストプロトコル（MCP）に基づいたサーバーであり、AIアシスタントとTianjiプラットフォームの間の橋渡しを担っています。このサーバーはMCPプロトコルを通じて、Tianjiプラットフォームのアンケート機能をAIアシスタントに公開します。サーバーの主な機能は以下の通りです。

- アンケート結果のクエリ
- 詳細なアンケート情報の取得
- ワークスペース内のすべてのアンケートの取得
- ウェブサイトリストの取得

## インストール方法

### NPXインストール

AIアシスタントの設定ファイルに以下の設定を追加することで、Tianji MCPサーバーを利用できます。

```json
{
  "mcpServers": {
    "tianji": {
      "type": "stdio",
      "command": "npx",
      "args": [
        "-y",
        "tianji-mcp-server"
      ],
      "env": {
        "TIANJI_BASE_URL": "https://tianji.example.com",
        "TIANJI_API_KEY": "<your-api-key>",
        "TIANJI_WORKSPACE_ID": "<your-workspace-id>"
      }
    }
  }
}
```

### 環境変数の設定

Tianji MCPサーバーを使用する前に、以下の環境変数を設定する必要があります。

```bash
# TianjiプラットフォームAPIのベースURL
TIANJI_BASE_URL=https://tianji.example.com

# TianjiプラットフォームAPIキー
TIANJI_API_KEY=your_api_key_here

# TianjiプラットフォームワークスペースID
TIANJI_WORKSPACE_ID=your_workspace_id_here
```

### APIキーの取得

TianjiプラットフォームAPIキーは、以下の手順で取得できます。

1. Tianjiプラットフォームにログイン後、右上の**プロフィール画像**をクリック
2. ドロップダウンメニューから**プロフィール**を選択
3. プロフィールページで**APIキー**オプションを確認
4. 新しいキーを作成をクリックし、プロンプトに従ってキーの作成を完了

## 使用方法

Tianji MCPサーバーは、MCPプロトコルを通じてAIアシスタントと連携できる一連のツールを提供します。以下は各ツールの詳細な説明です。

### アンケート結果のクエリ

`tianji_get_survey_results`ツールを使用して、特定アンケートの結果データをクエリします。

**パラメータ:**

- `workspaceId`: TianjiワークスペースID（環境変数で設定された値がデフォルト）
- `surveyId`: アンケートID
- `limit`: 返されるレコード数の上限（デフォルト20）
- `cursor`: ページングカーソル（オプション）
- `startAt`: 開始時間、ISO形式、例: 2023-10-01T00:00:00Z
- `endAt`: 終了時間、ISO形式、例: 2023-10-31T23:59:59Z
- `filter`: フィルター条件（オプション）

### アンケート情報の取得

`tianji_get_survey_info`ツールを使用して、特定アンケートの基本情報を取得します。

**パラメータ:**

- `workspaceId`: TianjiワークスペースID（環境変数で設定された値がデフォルト）
- `surveyId`: アンケートID

### すべてのアンケートリストの取得

`tianji_get_all_survey_list`ツールを使用して、ワークスペース内の全てのアンケートのリストを取得します。

**パラメータ:**

- `workspaceId`: TianjiワークスペースID（環境変数で設定された値がデフォルト）

### ウェブサイトリストの取得

`tianji_get_website_list`ツールを使用して、ワークスペース内のウェブサイトのリストを取得します。

**パラメータ:**

- `workspaceId`: TianjiワークスペースID（環境変数で設定された値がデフォルト）

## 使用例

以下は、Tianji MCPサーバーと統合されたAIアシスタントとの自然言語による対話の例です。

### 例1: すべてのアンケートリストの取得

```
ユーザー: すべてのアンケートリストを表示してください

AIアシスタント: あなたのアンケートリストを取得します。
[AIアシスタントはMCPプロトコルを通じてtianji_get_all_survey_listを呼び出しデータを取得]
ワークスペースに基づいて、現在以下のアンケートがあります:
1. ユーザー満足度アンケート（2023-09-15作成）
2. プロダクトフィードバックアンケート（2023-10-01作成）
3. ウェブサイト有用性評価（2023-10-20作成）
```

### 例2: 特定アンケートの詳細の取得

```
ユーザー: "ユーザー満足度アンケート"の詳細を教えてください

AIアシスタント: そのアンケートの詳細を問い合わせます。
[AIアシスタントはMCPプロトコルを通じてtianji_get_survey_infoを呼び出しデータを取得]
"ユーザー満足度アンケート"の詳細:
- 作成日時: 2023-09-15
- ステータス: アクティブ
- 質問数: 10
- 回収された回答: 128
- 最新の回答: 2023-10-25
```

### 例3: アンケート結果のクエリ

```
ユーザー: "プロダクトフィードバックアンケート"の10月の結果を分析してください

AIアシスタント: "プロダクトフィードバックアンケート"の10月の結果を分析します。
[AIアシスタントはMCPプロトコルを通じてtianji_get_survey_resultsを呼び出し特定の期間のデータを取得]
10月の"プロダクトフィードバックアンケート"結果の分析:
- 総回答数: 42
- 最も人気のある機能: 自動レポート（85%のポジティブフィードバック）
- 改善が最も必要な機能: モバイル対応（62%が言及）
- 平均満足度評価: 4.2/5
- 主なユーザーの提案: データエクスポート機能の追加、ページ読み込み速度の最適化
```
